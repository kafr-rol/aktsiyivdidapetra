<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–¶–µ–ª—å –¢–¶–ö –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</title>
  <style>
    body {background:#000; color:#0f0; font-family:Comic Sans MS,cursive; text-align:center; padding:20px;}
    h1 {color:#f00; font-size:3.5em; margin:30px;}
    button {padding:25px 60px; font-size:2.5em; background:#f00; color:#000; border:6px solid #0f0; cursor:pointer; margin:40px;}
    #result {margin:40px auto; max-width:900px; background:rgba(0,0,0,0.8); padding:35px; border:4px dashed #0f0;}
    img {max-width:100%; border:6px solid #f00; margin:25px 0;}
    .word {color:#ff0; font-size:3.2em; font-weight:bold; margin:25px 0;}
    #loading {display:none; font-size:2.8em; color:#ff0; margin:40px;}
  </style>
</head>
<body>
  <h1>–¶–ï–õ–¨ –¢–¶–ö –ù–ê –°–ï–ì–û–î–ù–Ø üî•</h1>
  
  <button onclick="generateTarget()">–î–ê–ô –¶–ï–õ–¨!</button>
  <div id="loading">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º... 5‚Äì15 —Å–µ–∫ üí®üñºÔ∏è</div>
  <div id="result"></div>

  <script>
    async function generateTarget() {
      const loading = document.getElementById('loading');
      const result = document.getElementById('result');
      result.innerHTML = '';
      loading.style.display = 'block';

      try {
        const res = await fetch('/.netlify/functions/generate');
        const data = await res.json();

        if (data.error) throw new Error(data.error);

        const { word, explanation, destination, prompt } = data;

        const image = await puter.ai.txt2img(prompt, {
          model: "black-forest-labs/FLUX.1-schnell",
          aspectRatio: "3:4",
          steps: 20
        });

        const today = new Date().toLocaleDateString('ru-RU');
        result.innerHTML = `
          <h2 style="color:#ff0;">–í–†–ê–ì ‚Ññ${Math.floor(Math.random()*99999)} ‚Äî ${today}</h2>
          <div class="word">${word.toUpperCase()}</div>
          <p><strong>–ü–æ—á–µ–º—É –ø—Ä–æ–≤–∏–Ω–∏–ª—Å—è:</strong> ${explanation}</p>
          <p><strong>–ö—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å:</strong> ${destination}</p>
          <img src="$$   {image.url}" alt="   $${word}">
          <br><button onclick="location.reload()" style="margin-top:30px;font-size:1.8em;">–ï–©–Å!</button>
        `;
      } catch (err) {
        result.innerHTML = `<p style="color:#f00;font-size:1.8em;">–û—à–∏–±–∫–∞: ${err.message}</p>`;
      }

      loading.style.display = 'none';
    }
  </script>
</body>
</html>
